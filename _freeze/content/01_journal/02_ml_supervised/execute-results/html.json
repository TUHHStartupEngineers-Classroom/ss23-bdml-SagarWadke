{
  "hash": "19762b55f4be2549c5fbb6880d2bd858",
  "result": {
    "markdown": "---\ntitle: \"02 Supervised ML\"\nauthor: \"Sagar Wadke\"\n---\n\n\n\n::: {.cell hash='02_ml_supervised_cache/html/unnamed-chunk-2_e28ef1c0dd37e9323804c602c72f9fc9'}\n\n```{.r .cell-code}\nlibrary(tidymodels)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n#> -- Attaching packages -------------------------------------- tidymodels 1.1.0 --\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n#> v broom        1.0.4     v recipes      1.0.6\n#> v dials        1.2.0     v rsample      1.1.1\n#> v dplyr        1.1.2     v tibble       3.2.1\n#> v ggplot2      3.4.2     v tidyr        1.3.0\n#> v infer        1.0.4     v tune         1.1.1\n#> v modeldata    1.1.0     v workflows    1.1.3\n#> v parsnip      1.1.0     v workflowsets 1.0.1\n#> v purrr        1.0.1     v yardstick    1.2.0\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n#> Warning: package 'broom' was built under R version 4.1.3\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n#> Warning: package 'dials' was built under R version 4.1.3\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n#> Warning: package 'scales' was built under R version 4.1.3\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n#> Warning: package 'dplyr' was built under R version 4.1.3\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n#> Warning: package 'ggplot2' was built under R version 4.1.3\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n#> Warning: package 'infer' was built under R version 4.1.3\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n#> Warning: package 'modeldata' was built under R version 4.1.3\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n#> Warning: package 'parsnip' was built under R version 4.1.3\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n#> Warning: package 'purrr' was built under R version 4.1.3\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n#> Warning: package 'rsample' was built under R version 4.1.3\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n#> Warning: package 'tibble' was built under R version 4.1.3\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n#> Warning: package 'tidyr' was built under R version 4.1.3\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n#> Warning: package 'tune' was built under R version 4.1.3\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n#> Warning: package 'workflows' was built under R version 4.1.3\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n#> Warning: package 'workflowsets' was built under R version 4.1.3\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n#> -- Conflicts ----------------------------------------- tidymodels_conflicts() --\n#> x purrr::discard() masks scales::discard()\n#> x dplyr::filter()  masks stats::filter()\n#> x dplyr::lag()     masks stats::lag()\n#> x recipes::step()  masks stats::step()\n#> * Use tidymodels_prefer() to resolve common conflicts.\n```\n:::\n\n```{.r .cell-code}\nlibrary(broom.mixed)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n#> Warning: package 'broom.mixed' was built under R version 4.1.3\n```\n:::\n\n```{.r .cell-code}\nlibrary(xgboost)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n#> \n#> Attaching package: 'xgboost'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n#> The following object is masked from 'package:dplyr':\n#> \n#>     slice\n```\n:::\n\n```{.r .cell-code}\nlibrary(tidyverse)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n#> Warning: package 'tidyverse' was built under R version 4.1.3\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n#> Warning: package 'readr' was built under R version 4.1.3\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n#> Warning: package 'stringr' was built under R version 4.1.3\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n#> Warning: package 'forcats' was built under R version 4.1.3\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n#> Warning: package 'lubridate' was built under R version 4.1.3\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n#> -- Attaching core tidyverse packages ------------------------ tidyverse 2.0.0 --\n#> v forcats   1.0.0     v readr     2.1.4\n#> v lubridate 1.9.2     v stringr   1.5.0\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n#> -- Conflicts ------------------------------------------ tidyverse_conflicts() --\n#> x readr::col_factor() masks scales::col_factor()\n#> x purrr::discard()    masks scales::discard()\n#> x dplyr::filter()     masks stats::filter()\n#> x stringr::fixed()    masks recipes::fixed()\n#> x dplyr::lag()        masks stats::lag()\n#> x xgboost::slice()    masks dplyr::slice()\n#> x readr::spec()       masks yardstick::spec()\n#> i Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors\n```\n:::\n\n```{.r .cell-code}\nlibrary(parsnip)\nlibrary(recipes)\nlibrary(rsample)\nlibrary(yardstick)\nlibrary(rpart.plot)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n#> Warning: package 'rpart.plot' was built under R version 4.1.3\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n#> Loading required package: rpart\n#> \n#> Attaching package: 'rpart'\n#> \n#> The following object is masked from 'package:dials':\n#> \n#>     prune\n```\n:::\n\n```{.r .cell-code}\nlibrary(modeldata)\n# Data exploration\nbike_data_tbl <- readRDS(\"C:/Users/Sagar/Documents/GitHub/ss23-bdml-SagarWadke/raw_data/bike_orderlines.rds\")\nmodel_sales_tbl <- bike_data_tbl %>%\n  select(total_price, model, category_2, frame_material) %>%\n  \n  group_by(model, category_2, frame_material) %>%\n  summarise(total_sales = sum(total_price)) %>%\n  ungroup() %>%\n  \n  arrange(desc(total_sales))\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n#> `summarise()` has grouped output by 'model', 'category_2'. You can override\n#> using the `.groups` argument.\n```\n:::\n\n```{.r .cell-code}\nmodel_sales_tbl %>%\n  mutate(category_2 = as_factor(category_2) %>% \n           fct_reorder(total_sales, .fun = max) %>% \n           fct_rev()) %>%\n  \n  ggplot(aes(frame_material, total_sales)) +\n  geom_violin() +\n  geom_jitter(width = 0.1, alpha = 0.5, color = \"#2c3e50\") +\n  #coord_flip() +\n  facet_wrap(~ category_2) +\n  scale_y_continuous(labels = scales::dollar_format(scale = 1e-6, suffix = \"M\", accuracy = 0.1)) +\n  tidyquant::theme_tq() +\n  labs(\n    title = \"Total Sales for Each Model\",\n    x = \"Frame Material\", y = \"Revenue\"\n  )\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n#> Registered S3 method overwritten by 'quantmod':\n#>   method            from\n#>   as.zoo.data.frame zoo\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n#> Warning: Groups with fewer than two data points have been dropped.\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n#> Warning: Groups with fewer than two data points have been dropped.\n#> Groups with fewer than two data points have been dropped.\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n#> Warning in max(data$density): no non-missing arguments to max; returning -Inf\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n#> Warning: Computation failed in `stat_ydensity()`\n#> Caused by error in `$<-.data.frame`:\n#> ! replacement has 1 row, data has 0\n```\n:::\n\n::: {.cell-output-display}\n![](02_ml_supervised_files/figure-html/unnamed-chunk-2-1.png){width=672}\n:::\n\n```{.r .cell-code}\nbike_features_tbl <- readRDS(\"C:/Users/Sagar/Documents/GitHub/ss23-bdml-SagarWadke/raw_data/bike_features_tbl.rds\")\nbike_features_tbl <- bike_features_tbl %>% \n  select(frame_material:gender, `Rear Derailleur`, `Shift Lever`) %>% \n  mutate(\n    `shimano dura-ace`        = `Rear Derailleur` %>% str_to_lower() %>% str_detect(\"shimano dura-ace \") %>% as.numeric(),\n    `shimano ultegra`         = `Rear Derailleur` %>% str_to_lower() %>% str_detect(\"shimano ultegra \") %>% as.numeric(),\n    `shimano 105`             = `Rear Derailleur` %>% str_to_lower() %>% str_detect(\"shimano 105 \") %>% as.numeric(),\n    `shimano tiagra`          = `Rear Derailleur` %>% str_to_lower() %>% str_detect(\"shimano tiagra \") %>% as.numeric(),\n    `Shimano sora`            = `Rear Derailleur` %>% str_to_lower() %>% str_detect(\"shimano sora\") %>% as.numeric(),\n    `shimano deore`           = `Rear Derailleur` %>% str_to_lower() %>% str_detect(\"shimano deore(?! xt)\") %>% as.numeric(),\n    `shimano slx`             = `Rear Derailleur` %>% str_to_lower() %>% str_detect(\"shimano slx\") %>% as.numeric(),\n    `shimano grx`             = `Rear Derailleur` %>% str_to_lower() %>% str_detect(\"shimano grx\") %>% as.numeric(),\n    `Shimano xt`              = `Rear Derailleur` %>% str_to_lower() %>% str_detect(\"shimano deore xt |shimano xt \") %>% as.numeric(),\n    `Shimano xtr`             = `Rear Derailleur` %>% str_to_lower() %>% str_detect(\"shimano xtr\") %>% as.numeric(),\n    `Shimano saint`           = `Rear Derailleur` %>% str_to_lower() %>% str_detect(\"shimano saint\") %>% as.numeric(),\n    `SRAM red`                = `Rear Derailleur` %>% str_to_lower() %>% str_detect(\"sram red\") %>% as.numeric(),\n    `SRAM force`              = `Rear Derailleur` %>% str_to_lower() %>% str_detect(\"sram force\") %>% as.numeric(),\n    `SRAM rival`              = `Rear Derailleur` %>% str_to_lower() %>% str_detect(\"sram rival\") %>% as.numeric(),\n    `SRAM apex`               = `Rear Derailleur` %>% str_to_lower() %>% str_detect(\"sram apex\") %>% as.numeric(),\n    `SRAM xx1`                = `Rear Derailleur` %>% str_to_lower() %>% str_detect(\"sram xx1\") %>% as.numeric(),\n    `SRAM x01`                = `Rear Derailleur` %>% str_to_lower() %>% str_detect(\"sram x01|sram xo1\") %>% as.numeric(),\n    `SRAM gx`                 = `Rear Derailleur` %>% str_to_lower() %>% str_detect(\"sram gx\") %>% as.numeric(),\n    `SRAM nx`                 = `Rear Derailleur` %>% str_to_lower() %>% str_detect(\"sram nx\") %>% as.numeric(),\n    `SRAM sx`                 = `Rear Derailleur` %>% str_to_lower() %>% str_detect(\"sram sx\") %>% as.numeric(),\n    `SRAM sx`                 = `Rear Derailleur` %>% str_to_lower() %>% str_detect(\"sram sx\") %>% as.numeric(),\n    `Campagnolo potenza`      = `Rear Derailleur` %>% str_to_lower() %>% str_detect(\"campagnolo potenza\") %>% as.numeric(),\n    `Campagnolo super record` = `Rear Derailleur` %>% str_to_lower() %>% str_detect(\"campagnolo super record\") %>% as.numeric(),\n    `shimano nexus`           = `Shift Lever`     %>% str_to_lower() %>% str_detect(\"shimano nexus\") %>% as.numeric(),\n    `shimano alfine`          = `Shift Lever`     %>% str_to_lower() %>% str_detect(\"shimano alfine\") %>% as.numeric()\n  ) %>%  \n  select(-c(`Rear Derailleur`, `Shift Lever`)) %>% \n  mutate_if(is.numeric, ~replace(., is.na(.), 0)) \nbike_features_tbl <- bike_features_tbl %>% \n  mutate(id = row_number()) %>% \n  mutate(frame_material = factor(frame_material)) %>%\n  select(id, everything()) \nbike_features_tbl %>% distinct(category_2)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"category_2\"],\"name\":[1],\"type\":[\"chr\"],\"align\":[\"left\"]}],\"data\":[{\"1\":\"Race\"},{\"1\":\"Endurance\"},{\"1\":\"E-Road\"},{\"1\":\"Cyclocross\"},{\"1\":\"Triathlon Bike\"},{\"1\":\"Fat Bikes\"},{\"1\":\"Cross-Country\"},{\"1\":\"Adventure\"},{\"1\":\"All-Road\"},{\"1\":\"E-Gravel\"},{\"1\":\"Trail\"},{\"1\":\"E-Mountain\"},{\"1\":\"Downhill\"},{\"1\":\"Dirt Jump\"},{\"1\":\"Enduro\"},{\"1\":\"E-City\"},{\"1\":\"E-Trekking\"},{\"1\":\"E-Fitness\"},{\"1\":\"City\"},{\"1\":\"Touring\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n\n```{.r .cell-code}\nsplit_obj <- rsample::initial_split(bike_features_tbl, prop   = 0.80, \n                                    strata = \"category_2\")\nsplit_obj %>% training() %>% distinct(category_2)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"category_2\"],\"name\":[1],\"type\":[\"chr\"],\"align\":[\"left\"]}],\"data\":[{\"1\":\"Race\"},{\"1\":\"Endurance\"},{\"1\":\"E-Road\"},{\"1\":\"Cyclocross\"},{\"1\":\"Triathlon Bike\"},{\"1\":\"Cross-Country\"},{\"1\":\"All-Road\"},{\"1\":\"E-Gravel\"},{\"1\":\"E-Mountain\"},{\"1\":\"Downhill\"},{\"1\":\"Enduro\"},{\"1\":\"E-City\"},{\"1\":\"E-Trekking\"},{\"1\":\"E-Fitness\"},{\"1\":\"City\"},{\"1\":\"Touring\"},{\"1\":\"Fat Bikes\"},{\"1\":\"Adventure\"},{\"1\":\"Trail\"},{\"1\":\"Dirt Jump\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n\n```{.r .cell-code}\nsplit_obj %>% testing() %>% distinct(category_2)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"category_2\"],\"name\":[1],\"type\":[\"chr\"],\"align\":[\"left\"]}],\"data\":[{\"1\":\"Race\"},{\"1\":\"Endurance\"},{\"1\":\"Triathlon Bike\"},{\"1\":\"Fat Bikes\"},{\"1\":\"Cross-Country\"},{\"1\":\"All-Road\"},{\"1\":\"E-Gravel\"},{\"1\":\"Trail\"},{\"1\":\"E-Mountain\"},{\"1\":\"Downhill\"},{\"1\":\"Dirt Jump\"},{\"1\":\"Enduro\"},{\"1\":\"E-Trekking\"},{\"1\":\"City\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n\n```{.r .cell-code}\ntrain_tbl <- training(split_obj)\ntest_tbl  <- testing(split_obj)\ntrain_data <- train_tbl %>% set_names(str_replace_all(names(train_tbl), \" |-\", \"_\"))\ntest_data  <- test_tbl  %>% set_names(str_replace_all(names(test_tbl),  \" |-\", \"_\"))\n# recipe\nbike_rec <- \n  recipe(frame_material ~ ., data = train_data) %>% \n  step_dummy(all_nominal(), -all_outcomes()) %>% \n  step_zv(all_predictors()) \nd <- summary(bike_rec)\nlr_mod <- \n  logistic_reg() %>% \n  set_engine(\"glm\")\nlr_mod\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#> Logistic Regression Model Specification (classification)\n#> \n#> Computational engine: glm\n```\n:::\n\n```{.r .cell-code}\nbike_wflow <- \n  workflow() %>% \n  add_model(lr_mod) %>% \n  add_recipe(bike_rec)\nbike_wflow\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#> == Workflow ====================================================================\n#> Preprocessor: Recipe\n#> Model: logistic_reg()\n#> \n#> -- Preprocessor ----------------------------------------------------------------\n#> 2 Recipe Steps\n#> \n#> * step_dummy()\n#> * step_zv()\n#> \n#> -- Model -----------------------------------------------------------------------\n#> Logistic Regression Model Specification (classification)\n#> \n#> Computational engine: glm\n```\n:::\n\n```{.r .cell-code}\nbike_fit <- \n  bike_wflow %>% \n  fit(data = train_data)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n#> Warning: glm.fit: algorithm did not converge\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n#> Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred\n```\n:::\n\n```{.r .cell-code}\nbike_fit\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#> == Workflow [trained] ==========================================================\n#> Preprocessor: Recipe\n#> Model: logistic_reg()\n#> \n#> -- Preprocessor ----------------------------------------------------------------\n#> 2 Recipe Steps\n#> \n#> * step_dummy()\n#> * step_zv()\n#> \n#> -- Model -----------------------------------------------------------------------\n#> \n#> Call:  stats::glm(formula = ..y ~ ., family = stats::binomial, data = data)\n#> \n#> Coefficients:\n#>                (Intercept)                          id  \n#>                  1.707e+23                   1.124e+09  \n#>                     weight                       price  \n#>                 -3.334e+09                   3.594e+06  \n#>           shimano_dura_ace             shimano_ultegra  \n#>                  1.656e+15                  -7.576e+14  \n#>                shimano_105              shimano_tiagra  \n#>                 -7.576e+14                  -7.576e+14  \n#>              shimano_deore                 shimano_slx  \n#>                  1.514e+15                  -3.285e+14  \n#>                shimano_grx                  Shimano_xt  \n#>                  3.026e+15                  -1.128e+15  \n#>                   SRAM_red                  SRAM_force  \n#>                  3.863e+14                   3.026e+15  \n#>                 SRAM_rival                   SRAM_apex  \n#>                  3.306e+15                  -9.603e+14  \n#>                   SRAM_xx1                    SRAM_x01  \n#>                  3.041e+15                   3.026e+15  \n#>                    SRAM_gx                     SRAM_nx  \n#>                 -4.219e+09                   2.787e+15  \n#>                    SRAM_sx          Campagnolo_potenza  \n#>                  1.123e+15                  -7.576e+14  \n#>    Campagnolo_super_record               shimano_nexus  \n#>                  3.844e+14                  -2.404e+15  \n#>             shimano_alfine           category_1_Gravel  \n#>                 -2.404e+15                  -1.194e+24  \n#>   category_1_Hybrid...City         category_1_Mountain  \n#>                 -1.707e+23                  -1.110e+24  \n#>            category_1_Road         category_2_All.Road  \n#>                 -2.449e+23                   3.572e+10  \n#>            category_2_City    category_2_Cross.Country  \n#>                  3.906e+15                  -8.419e+22  \n#>      category_2_Cyclocross        category_2_Dirt.Jump  \n#>                  7.424e+22                   9.391e+23  \n#>        category_2_Downhill           category_2_E.City  \n#>                  9.391e+23                  -1.707e+23  \n#>       category_2_E.Fitness         category_2_E.Gravel  \n#>                 -1.707e+23                  -1.707e+23  \n#>      category_2_E.Mountain           category_2_E.Road  \n#>                 -1.707e+23                  -1.707e+23  \n#>      category_2_E.Trekking        category_2_Endurance  \n#>                 -1.707e+23                   7.424e+22  \n#>          category_2_Enduro        category_2_Fat.Bikes  \n#>                  9.391e+23                   9.391e+23  \n#>            category_2_Race          category_2_Touring  \n#>                  7.424e+22                          NA  \n#> \n#> ...\n#> and 34 more lines.\n```\n:::\n\n```{.r .cell-code}\nbike_fit %>% \n  pull_workflow_fit() %>% \n  tidy()\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n#> Warning: `pull_workflow_fit()` was deprecated in workflows 0.2.3.\n#> i Please use `extract_fit_parsnip()` instead.\n```\n:::\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"term\"],\"name\":[1],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"estimate\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"std.error\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"statistic\"],\"name\":[4],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"p.value\"],\"name\":[5],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"(Intercept)\",\"2\":\"1.706783e+23\",\"3\":\"7.862355e+15\",\"4\":\"2.170829e+07\",\"5\":\"0.000000000\"},{\"1\":\"id\",\"2\":\"1.123644e+09\",\"3\":\"5.081424e+03\",\"4\":\"2.211278e+05\",\"5\":\"0.000000000\"},{\"1\":\"weight\",\"2\":\"-3.333887e+09\",\"3\":\"1.882189e+04\",\"4\":\"-1.771282e+05\",\"5\":\"0.000000000\"},{\"1\":\"price\",\"2\":\"3.593638e+06\",\"3\":\"1.423108e+01\",\"4\":\"2.525203e+05\",\"5\":\"0.000000000\"},{\"1\":\"shimano_dura_ace\",\"2\":\"1.656317e+15\",\"3\":\"8.080504e+07\",\"4\":\"2.049770e+07\",\"5\":\"0.000000000\"},{\"1\":\"shimano_ultegra\",\"2\":\"-7.576469e+14\",\"3\":\"7.750357e+07\",\"4\":\"-9.775638e+06\",\"5\":\"0.000000000\"},{\"1\":\"shimano_105\",\"2\":\"-7.576402e+14\",\"3\":\"7.750360e+07\",\"4\":\"-9.775549e+06\",\"5\":\"0.000000000\"},{\"1\":\"shimano_tiagra\",\"2\":\"-7.576250e+14\",\"3\":\"8.664886e+07\",\"4\":\"-8.743624e+06\",\"5\":\"0.000000000\"},{\"1\":\"shimano_deore\",\"2\":\"1.514026e+15\",\"3\":\"3.508541e+07\",\"4\":\"4.315259e+07\",\"5\":\"0.000000000\"},{\"1\":\"shimano_slx\",\"2\":\"-3.285418e+14\",\"3\":\"5.731370e+07\",\"4\":\"-5.732343e+06\",\"5\":\"0.000000000\"},{\"1\":\"shimano_grx\",\"2\":\"3.025775e+15\",\"3\":\"7.065236e+07\",\"4\":\"4.282624e+07\",\"5\":\"0.000000000\"},{\"1\":\"Shimano_xt\",\"2\":\"-1.128031e+15\",\"3\":\"4.315040e+07\",\"4\":\"-2.614184e+07\",\"5\":\"0.000000000\"},{\"1\":\"SRAM_red\",\"2\":\"3.862908e+14\",\"3\":\"7.904886e+07\",\"4\":\"4.886735e+06\",\"5\":\"0.000000000\"},{\"1\":\"SRAM_force\",\"2\":\"3.025773e+15\",\"3\":\"7.065236e+07\",\"4\":\"4.282622e+07\",\"5\":\"0.000000000\"},{\"1\":\"SRAM_rival\",\"2\":\"3.306366e+15\",\"3\":\"1.016771e+08\",\"4\":\"3.251829e+07\",\"5\":\"0.000000000\"},{\"1\":\"SRAM_apex\",\"2\":\"-9.603166e+14\",\"3\":\"8.890385e+07\",\"4\":\"-1.080174e+07\",\"5\":\"0.000000000\"},{\"1\":\"SRAM_xx1\",\"2\":\"3.040731e+15\",\"3\":\"3.990077e+07\",\"4\":\"7.620734e+07\",\"5\":\"0.000000000\"},{\"1\":\"SRAM_x01\",\"2\":\"3.025792e+15\",\"3\":\"2.209423e+07\",\"4\":\"1.369494e+08\",\"5\":\"0.000000000\"},{\"1\":\"SRAM_gx\",\"2\":\"-4.218534e+09\",\"3\":\"2.054236e+04\",\"4\":\"-2.053578e+05\",\"5\":\"0.000000000\"},{\"1\":\"SRAM_nx\",\"2\":\"2.786838e+15\",\"3\":\"3.545240e+07\",\"4\":\"7.860789e+07\",\"5\":\"0.000000000\"},{\"1\":\"SRAM_sx\",\"2\":\"1.122568e+15\",\"3\":\"3.739199e+07\",\"4\":\"3.002161e+07\",\"5\":\"0.000000000\"},{\"1\":\"Campagnolo_potenza\",\"2\":\"-7.576448e+14\",\"3\":\"1.025203e+08\",\"4\":\"-7.390195e+06\",\"5\":\"0.000000000\"},{\"1\":\"Campagnolo_super_record\",\"2\":\"3.844304e+14\",\"3\":\"7.904528e+07\",\"4\":\"4.863420e+06\",\"5\":\"0.000000000\"},{\"1\":\"shimano_nexus\",\"2\":\"-2.403752e+15\",\"3\":\"8.704376e+07\",\"4\":\"-2.761545e+07\",\"5\":\"0.000000000\"},{\"1\":\"shimano_alfine\",\"2\":\"-2.403757e+15\",\"3\":\"7.297133e+07\",\"4\":\"-3.294111e+07\",\"5\":\"0.000000000\"},{\"1\":\"category_1_Gravel\",\"2\":\"-1.194007e+24\",\"3\":\"8.268197e+16\",\"4\":\"-1.444096e+07\",\"5\":\"0.000000000\"},{\"1\":\"category_1_Hybrid...City\",\"2\":\"-1.706783e+23\",\"3\":\"7.862354e+15\",\"4\":\"-2.170829e+07\",\"5\":\"0.000000000\"},{\"1\":\"category_1_Mountain\",\"2\":\"-1.109813e+24\",\"3\":\"6.161817e+16\",\"4\":\"-1.801113e+07\",\"5\":\"0.000000000\"},{\"1\":\"category_1_Road\",\"2\":\"-2.449193e+23\",\"3\":\"1.819857e+16\",\"4\":\"-1.345816e+07\",\"5\":\"0.000000000\"},{\"1\":\"category_2_All.Road\",\"2\":\"3.572366e+10\",\"3\":\"6.710893e+07\",\"4\":\"5.323234e+02\",\"5\":\"0.000000000\"},{\"1\":\"category_2_City\",\"2\":\"3.905674e+15\",\"3\":\"8.498417e+07\",\"4\":\"4.595767e+07\",\"5\":\"0.000000000\"},{\"1\":\"category_2_Cross.Country\",\"2\":\"-8.419391e+22\",\"3\":\"3.175773e+16\",\"4\":\"-2.651131e+06\",\"5\":\"0.000000000\"},{\"1\":\"category_2_Cyclocross\",\"2\":\"7.424098e+22\",\"3\":\"1.158909e+16\",\"4\":\"6.406107e+06\",\"5\":\"0.000000000\"},{\"1\":\"category_2_Dirt.Jump\",\"2\":\"9.391346e+23\",\"3\":\"5.493102e+16\",\"4\":\"1.709662e+07\",\"5\":\"0.000000000\"},{\"1\":\"category_2_Downhill\",\"2\":\"9.391346e+23\",\"3\":\"5.493102e+16\",\"4\":\"1.709662e+07\",\"5\":\"0.000000000\"},{\"1\":\"category_2_E.City\",\"2\":\"-1.706783e+23\",\"3\":\"7.862351e+15\",\"4\":\"-2.170830e+07\",\"5\":\"0.000000000\"},{\"1\":\"category_2_E.Fitness\",\"2\":\"-1.706783e+23\",\"3\":\"7.862348e+15\",\"4\":\"-2.170831e+07\",\"5\":\"0.000000000\"},{\"1\":\"category_2_E.Gravel\",\"2\":\"-1.706783e+23\",\"3\":\"7.862353e+15\",\"4\":\"-2.170830e+07\",\"5\":\"0.000000000\"},{\"1\":\"category_2_E.Mountain\",\"2\":\"-1.706783e+23\",\"3\":\"7.862351e+15\",\"4\":\"-2.170830e+07\",\"5\":\"0.000000000\"},{\"1\":\"category_2_E.Road\",\"2\":\"-1.706783e+23\",\"3\":\"7.862352e+15\",\"4\":\"-2.170830e+07\",\"5\":\"0.000000000\"},{\"1\":\"category_2_E.Trekking\",\"2\":\"-1.706783e+23\",\"3\":\"7.862350e+15\",\"4\":\"-2.170830e+07\",\"5\":\"0.000000000\"},{\"1\":\"category_2_Endurance\",\"2\":\"7.424098e+22\",\"3\":\"1.158909e+16\",\"4\":\"6.406107e+06\",\"5\":\"0.000000000\"},{\"1\":\"category_2_Enduro\",\"2\":\"9.391346e+23\",\"3\":\"5.493102e+16\",\"4\":\"1.709662e+07\",\"5\":\"0.000000000\"},{\"1\":\"category_2_Fat.Bikes\",\"2\":\"9.391346e+23\",\"3\":\"5.493102e+16\",\"4\":\"1.709662e+07\",\"5\":\"0.000000000\"},{\"1\":\"category_2_Race\",\"2\":\"7.424098e+22\",\"3\":\"1.158909e+16\",\"4\":\"6.406108e+06\",\"5\":\"0.000000000\"},{\"1\":\"category_2_Touring\",\"2\":\"NA\",\"3\":\"NA\",\"4\":\"NA\",\"5\":\"NA\"},{\"1\":\"category_2_Trail\",\"2\":\"NA\",\"3\":\"NA\",\"4\":\"NA\",\"5\":\"NA\"},{\"1\":\"category_2_Triathlon.Bike\",\"2\":\"7.424098e+22\",\"3\":\"1.158909e+16\",\"4\":\"6.406107e+06\",\"5\":\"0.000000000\"},{\"1\":\"category_3_Commuter\",\"2\":\"-2.823227e+15\",\"3\":\"9.462528e+07\",\"4\":\"-2.983586e+07\",\"5\":\"0.000000000\"},{\"1\":\"category_3_Commuter.ON\",\"2\":\"1.559170e+08\",\"3\":\"5.811798e+07\",\"4\":\"2.682767e+00\",\"5\":\"0.007301577\"},{\"1\":\"category_3_Dude\",\"2\":\"NA\",\"3\":\"NA\",\"4\":\"NA\",\"5\":\"NA\"},{\"1\":\"category_3_Endurace\",\"2\":\"NA\",\"3\":\"NA\",\"4\":\"NA\",\"5\":\"NA\"},{\"1\":\"category_3_Endurace.ON\",\"2\":\"NA\",\"3\":\"NA\",\"4\":\"NA\",\"5\":\"NA\"},{\"1\":\"category_3_Exceed\",\"2\":\"1.023328e+24\",\"3\":\"7.570096e+16\",\"4\":\"1.351804e+07\",\"5\":\"0.000000000\"},{\"1\":\"category_3_Grail\",\"2\":\"1.023328e+24\",\"3\":\"7.570096e+16\",\"4\":\"1.351804e+07\",\"5\":\"0.000000000\"},{\"1\":\"category_3_Grail.ON\",\"2\":\"NA\",\"3\":\"NA\",\"4\":\"NA\",\"5\":\"NA\"},{\"1\":\"category_3_Grand.Canyon\",\"2\":\"9.391346e+23\",\"3\":\"5.493102e+16\",\"4\":\"1.709662e+07\",\"5\":\"0.000000000\"},{\"1\":\"category_3_Grand.Canyon.ON\",\"2\":\"-1.513967e+15\",\"3\":\"7.572746e+07\",\"4\":\"-1.999232e+07\",\"5\":\"0.000000000\"},{\"1\":\"category_3_Inflite\",\"2\":\"NA\",\"3\":\"NA\",\"4\":\"NA\",\"5\":\"NA\"},{\"1\":\"category_3_Lux\",\"2\":\"1.023328e+24\",\"3\":\"7.570096e+16\",\"4\":\"1.351804e+07\",\"5\":\"0.000000000\"},{\"1\":\"category_3_Neuron\",\"2\":\"9.391346e+23\",\"3\":\"5.493102e+16\",\"4\":\"1.709662e+07\",\"5\":\"0.000000000\"},{\"1\":\"category_3_Neuron.ON\",\"2\":\"1.286959e+10\",\"3\":\"3.874565e+07\",\"4\":\"3.321557e+02\",\"5\":\"0.000000000\"},{\"1\":\"category_3_Pathlite\",\"2\":\"NA\",\"3\":\"NA\",\"4\":\"NA\",\"5\":\"NA\"},{\"1\":\"category_3_Pathlite.ON\",\"2\":\"NA\",\"3\":\"NA\",\"4\":\"NA\",\"5\":\"NA\"},{\"1\":\"category_3_Precede.ON\",\"2\":\"NA\",\"3\":\"NA\",\"4\":\"NA\",\"5\":\"NA\"},{\"1\":\"category_3_Roadlite\",\"2\":\"NA\",\"3\":\"NA\",\"4\":\"NA\",\"5\":\"NA\"},{\"1\":\"category_3_Roadlite.ON\",\"2\":\"NA\",\"3\":\"NA\",\"4\":\"NA\",\"5\":\"NA\"},{\"1\":\"category_3_Sender\",\"2\":\"NA\",\"3\":\"NA\",\"4\":\"NA\",\"5\":\"NA\"},{\"1\":\"category_3_Spectral\",\"2\":\"9.391346e+23\",\"3\":\"5.493102e+16\",\"4\":\"1.709662e+07\",\"5\":\"0.000000000\"},{\"1\":\"category_3_Spectral.ON\",\"2\":\"NA\",\"3\":\"NA\",\"4\":\"NA\",\"5\":\"NA\"},{\"1\":\"category_3_Speedmax\",\"2\":\"NA\",\"3\":\"NA\",\"4\":\"NA\",\"5\":\"NA\"},{\"1\":\"category_3_Stitched\",\"2\":\"NA\",\"3\":\"NA\",\"4\":\"NA\",\"5\":\"NA\"},{\"1\":\"category_3_Strive\",\"2\":\"-2.385022e+14\",\"3\":\"4.579462e+07\",\"4\":\"-5.208083e+06\",\"5\":\"0.000000000\"},{\"1\":\"category_3_Torque\",\"2\":\"NA\",\"3\":\"NA\",\"4\":\"NA\",\"5\":\"NA\"},{\"1\":\"category_3_Ultimate\",\"2\":\"-4.467898e+15\",\"3\":\"3.530691e+07\",\"4\":\"-1.265446e+08\",\"5\":\"0.000000000\"},{\"1\":\"gender_unisex\",\"2\":\"1.296652e+09\",\"3\":\"6.213336e+03\",\"4\":\"2.086885e+05\",\"5\":\"0.000000000\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n\n```{.r .cell-code}\nbike_pred <- \n  predict(bike_fit, test_data, type=\"prob\") %>% \n  bind_cols(test_data %>% select(frame_material, category_2)) \n```\n\n::: {.cell-output .cell-output-stderr}\n```\n#> Warning in predict.lm(object, newdata, se.fit, scale = 1, type = if (type == :\n#> prediction from a rank-deficient fit may be misleading\n```\n:::\n\n```{.r .cell-code}\nbike_pred %>% \n  roc_curve(truth = frame_material, .pred_aluminium) %>% \n  autoplot()\n```\n\n::: {.cell-output-display}\n![](02_ml_supervised_files/figure-html/unnamed-chunk-2-2.png){width=672}\n:::\n\n```{.r .cell-code}\nbike_pred %>% \n  roc_curve(truth = frame_material, .pred_carbon) %>% \n  autoplot()\n```\n\n::: {.cell-output-display}\n![](02_ml_supervised_files/figure-html/unnamed-chunk-2-3.png){width=672}\n:::\n\n```{.r .cell-code}\nbike_pred\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\".pred_aluminium\"],\"name\":[1],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\".pred_carbon\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"frame_material\"],\"name\":[3],\"type\":[\"fct\"],\"align\":[\"left\"]},{\"label\":[\"category_2\"],\"name\":[4],\"type\":[\"chr\"],\"align\":[\"left\"]}],\"data\":[{\"1\":\"2.220446e-16\",\"2\":\"1.000000e+00\",\"3\":\"carbon\",\"4\":\"Race\"},{\"1\":\"2.220446e-16\",\"2\":\"1.000000e+00\",\"3\":\"carbon\",\"4\":\"Race\"},{\"1\":\"2.220446e-16\",\"2\":\"1.000000e+00\",\"3\":\"carbon\",\"4\":\"Race\"},{\"1\":\"1.000000e+00\",\"2\":\"2.220446e-16\",\"3\":\"aluminium\",\"4\":\"Endurance\"},{\"1\":\"2.220446e-16\",\"2\":\"1.000000e+00\",\"3\":\"carbon\",\"4\":\"Endurance\"},{\"1\":\"2.220446e-16\",\"2\":\"1.000000e+00\",\"3\":\"carbon\",\"4\":\"Endurance\"},{\"1\":\"2.220446e-16\",\"2\":\"1.000000e+00\",\"3\":\"carbon\",\"4\":\"Triathlon Bike\"},{\"1\":\"2.220446e-16\",\"2\":\"1.000000e+00\",\"3\":\"carbon\",\"4\":\"Triathlon Bike\"},{\"1\":\"2.220446e-16\",\"2\":\"1.000000e+00\",\"3\":\"carbon\",\"4\":\"Triathlon Bike\"},{\"1\":\"2.220446e-16\",\"2\":\"1.000000e+00\",\"3\":\"carbon\",\"4\":\"Triathlon Bike\"},{\"1\":\"2.220446e-16\",\"2\":\"1.000000e+00\",\"3\":\"carbon\",\"4\":\"Triathlon Bike\"},{\"1\":\"1.000000e+00\",\"2\":\"2.220446e-16\",\"3\":\"carbon\",\"4\":\"Race\"},{\"1\":\"2.220446e-16\",\"2\":\"1.000000e+00\",\"3\":\"carbon\",\"4\":\"Race\"},{\"1\":\"1.000000e+00\",\"2\":\"2.220446e-16\",\"3\":\"carbon\",\"4\":\"Race\"},{\"1\":\"1.000000e+00\",\"2\":\"2.220446e-16\",\"3\":\"carbon\",\"4\":\"Race\"},{\"1\":\"1.000000e+00\",\"2\":\"2.220446e-16\",\"3\":\"carbon\",\"4\":\"Race\"},{\"1\":\"2.220446e-16\",\"2\":\"1.000000e+00\",\"3\":\"carbon\",\"4\":\"Fat Bikes\"},{\"1\":\"2.220446e-16\",\"2\":\"1.000000e+00\",\"3\":\"carbon\",\"4\":\"Cross-Country\"},{\"1\":\"1.000000e+00\",\"2\":\"2.220446e-16\",\"3\":\"carbon\",\"4\":\"Cross-Country\"},{\"1\":\"2.220446e-16\",\"2\":\"1.000000e+00\",\"3\":\"carbon\",\"4\":\"All-Road\"},{\"1\":\"2.220446e-16\",\"2\":\"1.000000e+00\",\"3\":\"carbon\",\"4\":\"E-Gravel\"},{\"1\":\"1.000000e+00\",\"2\":\"2.220446e-16\",\"3\":\"aluminium\",\"4\":\"Trail\"},{\"1\":\"1.000000e+00\",\"2\":\"2.220446e-16\",\"3\":\"aluminium\",\"4\":\"E-Mountain\"},{\"1\":\"2.220446e-16\",\"2\":\"1.000000e+00\",\"3\":\"aluminium\",\"4\":\"E-Mountain\"},{\"1\":\"2.220446e-16\",\"2\":\"1.000000e+00\",\"3\":\"carbon\",\"4\":\"Cross-Country\"},{\"1\":\"2.220446e-16\",\"2\":\"1.000000e+00\",\"3\":\"carbon\",\"4\":\"Cross-Country\"},{\"1\":\"2.220446e-16\",\"2\":\"1.000000e+00\",\"3\":\"carbon\",\"4\":\"Cross-Country\"},{\"1\":\"1.000000e+00\",\"2\":\"2.220446e-16\",\"3\":\"aluminium\",\"4\":\"Trail\"},{\"1\":\"1.000000e+00\",\"2\":\"2.220446e-16\",\"3\":\"aluminium\",\"4\":\"Trail\"},{\"1\":\"2.220446e-16\",\"2\":\"1.000000e+00\",\"3\":\"aluminium\",\"4\":\"Trail\"},{\"1\":\"2.220446e-16\",\"2\":\"1.000000e+00\",\"3\":\"aluminium\",\"4\":\"E-Mountain\"},{\"1\":\"1.000000e+00\",\"2\":\"2.220446e-16\",\"3\":\"carbon\",\"4\":\"Downhill\"},{\"1\":\"1.000000e+00\",\"2\":\"2.220446e-16\",\"3\":\"aluminium\",\"4\":\"Trail\"},{\"1\":\"1.000000e+00\",\"2\":\"2.220446e-16\",\"3\":\"carbon\",\"4\":\"Trail\"},{\"1\":\"2.220446e-16\",\"2\":\"1.000000e+00\",\"3\":\"carbon\",\"4\":\"E-Mountain\"},{\"1\":\"2.220446e-16\",\"2\":\"1.000000e+00\",\"3\":\"carbon\",\"4\":\"E-Mountain\"},{\"1\":\"1.000000e+00\",\"2\":\"2.220446e-16\",\"3\":\"aluminium\",\"4\":\"Dirt Jump\"},{\"1\":\"1.000000e+00\",\"2\":\"2.220446e-16\",\"3\":\"aluminium\",\"4\":\"Dirt Jump\"},{\"1\":\"1.000000e+00\",\"2\":\"2.220446e-16\",\"3\":\"aluminium\",\"4\":\"Enduro\"},{\"1\":\"1.000000e+00\",\"2\":\"2.220446e-16\",\"3\":\"aluminium\",\"4\":\"E-Trekking\"},{\"1\":\"1.000000e+00\",\"2\":\"2.220446e-16\",\"3\":\"aluminium\",\"4\":\"E-Trekking\"},{\"1\":\"1.000000e+00\",\"2\":\"2.220446e-16\",\"3\":\"aluminium\",\"4\":\"E-Trekking\"},{\"1\":\"1.000000e+00\",\"2\":\"2.220446e-16\",\"3\":\"aluminium\",\"4\":\"E-Trekking\"},{\"1\":\"1.000000e+00\",\"2\":\"2.220446e-16\",\"3\":\"aluminium\",\"4\":\"City\"},{\"1\":\"1.000000e+00\",\"2\":\"2.220446e-16\",\"3\":\"aluminium\",\"4\":\"City\"},{\"1\":\"1.000000e+00\",\"2\":\"2.220446e-16\",\"3\":\"aluminium\",\"4\":\"City\"},{\"1\":\"1.000000e+00\",\"2\":\"2.220446e-16\",\"3\":\"aluminium\",\"4\":\"City\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n\n```{.r .cell-code}\nroc_al <- bike_pred %>% \n  roc_auc(truth = frame_material, .pred_aluminium)\nroc_al\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\".metric\"],\"name\":[1],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\".estimator\"],\"name\":[2],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\".estimate\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"roc_auc\",\"2\":\"binary\",\"3\":\"0.7953704\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n\n```{.r .cell-code}\nroc_car <- bike_pred %>% \n  roc_auc(truth = frame_material, .pred_carbon)\nroc_car\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\".metric\"],\"name\":[1],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\".estimator\"],\"name\":[2],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\".estimate\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"roc_auc\",\"2\":\"binary\",\"3\":\"0.2046296\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n\n```{.r .cell-code}\n# Evaluation\nmodel_01_linear_lm_simple <- linear_reg(mode = \"regression\") %>%\n  set_engine(\"lm\") %>%\n  fit(price ~ category_2 + frame_material, data = train_data)\nmodel_01_linear_lm_simple\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#> parsnip model object\n#> \n#> \n#> Call:\n#> stats::lm(formula = price ~ category_2 + frame_material, data = data)\n#> \n#> Coefficients:\n#>              (Intercept)        category_2All-Road            category_2City  \n#>                  2236.43                   -595.94                  -1332.15  \n#>  category_2Cross-Country      category_2Cyclocross       category_2Dirt Jump  \n#>                   -92.78                   -551.55                  -1017.43  \n#>       category_2Downhill          category_2E-City       category_2E-Fitness  \n#>                  1757.57                    784.19                    805.90  \n#>       category_2E-Gravel      category_2E-Mountain          category_2E-Road  \n#>                  1125.00                   1318.38                    682.57  \n#>     category_2E-Trekking       category_2Endurance          category_2Enduro  \n#>                   589.23                   -723.72                    497.79  \n#>      category_2Fat Bikes            category_2Race         category_2Touring  \n#>                 -1215.00                   1063.40                  -1064.93  \n#>          category_2Trail  category_2Triathlon Bike      frame_materialcarbon  \n#>                  -428.63                    185.00                   1607.57\n```\n:::\n\n```{.r .cell-code}\ntest_data <- test_data %>% filter(category_2 != \"Fat Bikes\")\nyards <- model_01_linear_lm_simple\nyards\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#> parsnip model object\n#> \n#> \n#> Call:\n#> stats::lm(formula = price ~ category_2 + frame_material, data = data)\n#> \n#> Coefficients:\n#>              (Intercept)        category_2All-Road            category_2City  \n#>                  2236.43                   -595.94                  -1332.15  \n#>  category_2Cross-Country      category_2Cyclocross       category_2Dirt Jump  \n#>                   -92.78                   -551.55                  -1017.43  \n#>       category_2Downhill          category_2E-City       category_2E-Fitness  \n#>                  1757.57                    784.19                    805.90  \n#>       category_2E-Gravel      category_2E-Mountain          category_2E-Road  \n#>                  1125.00                   1318.38                    682.57  \n#>     category_2E-Trekking       category_2Endurance          category_2Enduro  \n#>                   589.23                   -723.72                    497.79  \n#>      category_2Fat Bikes            category_2Race         category_2Touring  \n#>                 -1215.00                   1063.40                  -1064.93  \n#>          category_2Trail  category_2Triathlon Bike      frame_materialcarbon  \n#>                  -428.63                    185.00                   1607.57\n```\n:::\n\n```{.r .cell-code}\ng1 <- bike_features_tbl %>% \n  mutate(category_2 = as.factor(category_2) %>% \n           fct_reorder(price)) %>% \n  \n  ggplot(aes(category_2, price)) +\n  geom_violin() +\n  geom_jitter(width = 0.1, alpha = 0.5, color = \"#2dc6d6\") +\n  coord_flip() +\n  facet_wrap(~ frame_material) +\n  scale_y_continuous(labels = scales::dollar_format()) +\n  labs(\n    title = \"Unit Price for Each Model\",\n    y = \"\", x = \"Category 2\"\n  )\ng1\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n#> Warning: Groups with fewer than two data points have been dropped.\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n#> Warning: Groups with fewer than two data points have been dropped.\n#> Groups with fewer than two data points have been dropped.\n```\n:::\n\n::: {.cell-output-display}\n![](02_ml_supervised_files/figure-html/unnamed-chunk-2-4.png){width=672}\n:::\n\n```{.r .cell-code}\nnew_race_alu <- tibble(\n  model = \"Exceed AL SL new\",\n  category_2 = \"Race\",\n  frame_material = \"aluminium\",\n  shimano_dura_ace = 0,\n  shimano_ultegra = 0,\n  shimano_105 = 0,\n  shimano_tiagra = 0,\n  Shimano_sora = 0,\n  shimano_deore = 0,\n  shimano_slx = 0,\n  shimano_grx = 0,\n  Shimano_xt = 1,\n  Shimano_xtr = 0,\n  Shimano_saint = 0,\n  SRAM_red = 0,\n  SRAM_force = 0,\n  SRAM_rival = 0,\n  SRAM_apex = 0,\n  SRAM_xx1 = 0,\n  SRAM_x01 = 0,\n  SRAM_gx = 0,\n  SRAM_nx = 0,\n  SRAM_sx = 0,\n  Campagnolo_potenza = 0,\n  Campagnolo_super_record = 0,\n  shimano_nexus = 0,\n  shimano_alfine = 0\n) \nnew_race_alu\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"model\"],\"name\":[1],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"category_2\"],\"name\":[2],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"frame_material\"],\"name\":[3],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"shimano_dura_ace\"],\"name\":[4],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"shimano_ultegra\"],\"name\":[5],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"shimano_105\"],\"name\":[6],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"shimano_tiagra\"],\"name\":[7],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Shimano_sora\"],\"name\":[8],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"shimano_deore\"],\"name\":[9],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"shimano_slx\"],\"name\":[10],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"shimano_grx\"],\"name\":[11],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Shimano_xt\"],\"name\":[12],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Shimano_xtr\"],\"name\":[13],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Shimano_saint\"],\"name\":[14],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"SRAM_red\"],\"name\":[15],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"SRAM_force\"],\"name\":[16],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"SRAM_rival\"],\"name\":[17],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"SRAM_apex\"],\"name\":[18],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"SRAM_xx1\"],\"name\":[19],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"SRAM_x01\"],\"name\":[20],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"SRAM_gx\"],\"name\":[21],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"SRAM_nx\"],\"name\":[22],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"SRAM_sx\"],\"name\":[23],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Campagnolo_potenza\"],\"name\":[24],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Campagnolo_super_record\"],\"name\":[25],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"shimano_nexus\"],\"name\":[26],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"shimano_alfine\"],\"name\":[27],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"Exceed AL SL new\",\"2\":\"Race\",\"3\":\"aluminium\",\"4\":\"0\",\"5\":\"0\",\"6\":\"0\",\"7\":\"0\",\"8\":\"0\",\"9\":\"0\",\"10\":\"0\",\"11\":\"0\",\"12\":\"1\",\"13\":\"0\",\"14\":\"0\",\"15\":\"0\",\"16\":\"0\",\"17\":\"0\",\"18\":\"0\",\"19\":\"0\",\"20\":\"0\",\"21\":\"0\",\"22\":\"0\",\"23\":\"0\",\"24\":\"0\",\"25\":\"0\",\"26\":\"0\",\"27\":\"0\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n\n```{.r .cell-code}\npredict(model_01_linear_lm_simple, new_data = new_race_alu)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\".pred\"],\"name\":[1],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"3299.834\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n\n```{.r .cell-code}\nmodels_tbl <- tibble(\n  model_id = str_c(\"Model 0\", 1:1),\n  model = list(\n    model_01_linear_lm_simple\n  )\n)\nmodels_tbl\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"model_id\"],\"name\":[1],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"model\"],\"name\":[2],\"type\":[\"list\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"Model 01\",\"2\":\"<S3: _lm>\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n\n```{.r .cell-code}\npredictions_new_race_alu_tbl <- models_tbl %>%\n  mutate(predictions = map(model, predict, new_data = new_race_alu)) %>%\n  unnest(predictions) %>%\n  mutate(category_2 = \"Race\") %>%\n  left_join(new_race_alu, by = \"category_2\")\npredictions_new_race_alu_tbl\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"model_id\"],\"name\":[1],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"model.x\"],\"name\":[2],\"type\":[\"list\"],\"align\":[\"right\"]},{\"label\":[\".pred\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"category_2\"],\"name\":[4],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"model.y\"],\"name\":[5],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"frame_material\"],\"name\":[6],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"shimano_dura_ace\"],\"name\":[7],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"shimano_ultegra\"],\"name\":[8],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"shimano_105\"],\"name\":[9],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"shimano_tiagra\"],\"name\":[10],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Shimano_sora\"],\"name\":[11],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"shimano_deore\"],\"name\":[12],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"shimano_slx\"],\"name\":[13],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"shimano_grx\"],\"name\":[14],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Shimano_xt\"],\"name\":[15],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Shimano_xtr\"],\"name\":[16],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Shimano_saint\"],\"name\":[17],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"SRAM_red\"],\"name\":[18],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"SRAM_force\"],\"name\":[19],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"SRAM_rival\"],\"name\":[20],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"SRAM_apex\"],\"name\":[21],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"SRAM_xx1\"],\"name\":[22],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"SRAM_x01\"],\"name\":[23],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"SRAM_gx\"],\"name\":[24],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"SRAM_nx\"],\"name\":[25],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"SRAM_sx\"],\"name\":[26],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Campagnolo_potenza\"],\"name\":[27],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Campagnolo_super_record\"],\"name\":[28],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"shimano_nexus\"],\"name\":[29],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"shimano_alfine\"],\"name\":[30],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"Model 01\",\"2\":\"<S3: _lm>\",\"3\":\"3299.834\",\"4\":\"Race\",\"5\":\"Exceed AL SL new\",\"6\":\"aluminium\",\"7\":\"0\",\"8\":\"0\",\"9\":\"0\",\"10\":\"0\",\"11\":\"0\",\"12\":\"0\",\"13\":\"0\",\"14\":\"0\",\"15\":\"1\",\"16\":\"0\",\"17\":\"0\",\"18\":\"0\",\"19\":\"0\",\"20\":\"0\",\"21\":\"0\",\"22\":\"0\",\"23\":\"0\",\"24\":\"0\",\"25\":\"0\",\"26\":\"0\",\"27\":\"0\",\"28\":\"0\",\"29\":\"0\",\"30\":\"0\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n\n```{.r .cell-code}\ng2 <- g1 +\n  geom_point(aes(y = .pred), color = \"red\", alpha = 0.5,\n             data = predictions_new_race_alu_tbl) +\n  ggrepel::geom_text_repel(aes(label = model_id, y = .pred),\n                           size = 3,\n                           data = predictions_new_race_alu_tbl)\ng2\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n#> Warning: Groups with fewer than two data points have been dropped.\n#> Groups with fewer than two data points have been dropped.\n#> Groups with fewer than two data points have been dropped.\n```\n:::\n\n::: {.cell-output-display}\n![](02_ml_supervised_files/figure-html/unnamed-chunk-2-5.png){width=672}\n:::\n:::",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"../../site_libs/pagedtable-1.1/css/pagedtable.css\" rel=\"stylesheet\" />\r\n<script src=\"../../site_libs/pagedtable-1.1/js/pagedtable.js\"></script>\r\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}